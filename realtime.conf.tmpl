input {
  file {
    path => "/load/*/*"
    discover_interval => 2
  }
}
filter {
  csv {
    separator => "	"
  }

  grok {
    match => ["path","%{GREEDYDATA}/%{GREEDYDATA:type}/%{GREEDYDATA:filename}"]
  }
  mutate
  {
    remove_field => [ "message", "@version", "path"]
  }
}
output {
  elasticsearch {
    host => "elasticsearch"
    protocol => "transport"
    index => "logstash-%{filename}"
    workers => 8
    max_retries => 10
    retry_max_interval => 5
    retry_max_items => 100
    flush_size => 100
    timeout => 25
  }
}
